<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PokeCalc SV - 3v3 Simulation</title>
    <link rel="icon" href="../backend/data/image/PlaySphere.png">
    <link rel="stylesheet" href="style.css?v=21">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
</head>
<body>
    <!-- Êñ∞„Åó„ÅÑ„Éò„ÉÉ„ÉÄ„Éº -->
    <div class="top-header">
        <div class="header-inner">
            <div class="header-left">
                <button class="menu-btn" aria-label="„É°„Éã„É•„Éº">
                    <span class="menu-icon">‚ò∞</span>
                </button>
                <div class="logo">
                    <span class="logo-playsphere">PlaySphere</span>
                </div>
            </div>
            <div class="header-right">
                <button class="header-icon-btn settings-btn" aria-label="Ë®≠ÂÆö" title="Ë®≠ÂÆö">
                    <span class="icon">‚öô</span>
                </button>
                <button class="header-icon-btn notifications-btn" aria-label="ÈÄöÁü•" title="ÈÄöÁü•">
                    <span class="icon">üîî</span>
                </button>
                <button class="header-icon-btn user-btn" aria-label="„É¶„Éº„Ç∂„Éº" title="„É¶„Éº„Ç∂„Éº„É°„Éã„É•„Éº">
                    <span class="icon">üë§</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Êó¢Â≠ò„ÅÆ„Éò„ÉÉ„ÉÄ„ÉºÔºà„Éë„Éº„ÉÜ„Ç£„Çª„É¨„ÇØ„Çø„ÉºÔºâ -->
    <header>
        <h1>„Éù„Ç±„É¢„É≥ÂØæÊà¶„Ç∑„Éü„É•„É¨„Éº„Çø„Éº</h1>
        <div class="party-selector">
            <div class="team ally-team">
                <span>Ëá™ÂàÜ</span>
                <button class="poke-slot active" data-team="ally" data-index="0">1</button>
                <button class="poke-slot" data-team="ally" data-index="1">2</button>
                <button class="poke-slot" data-team="ally" data-index="2">3</button>
                <button class="poke-slot" data-team="ally" data-index="3">4</button>
                <button class="poke-slot" data-team="ally" data-index="4">5</button>
                <button class="poke-slot" data-team="ally" data-index="5">6</button>
            </div>
            
            <div class="versus-divider">
                <span class="vs-text">VS</span>
            </div>

            <div class="team enemy-team">
                <span>Áõ∏Êâã</span>
                <button class="poke-slot" data-team="enemy" data-index="0">1</button>
                <button class="poke-slot" data-team="enemy" data-index="1">2</button>
                <button class="poke-slot" data-team="enemy" data-index="2">3</button>
                <button class="poke-slot" data-team="enemy" data-index="3">4</button>
                <button class="poke-slot" data-team="enemy" data-index="4">5</button>
                <button class="poke-slot" data-team="enemy" data-index="5">6</button>
            </div>
        </div>
    </header>

    <!-- Mobile Tab Navigation -->
    <div class="mobile-tab-nav">
        <button class="tab-btn active" data-tab="ally">Ëá™ÂàÜ„ÅÆ„ÉÅ„Éº„É†</button>
        <button class="tab-btn" data-tab="battle">ÂØæÊà¶„É≠„Ç∞</button>
        <button class="tab-btn" data-tab="enemy">Áõ∏Êâã„ÅÆ„ÉÅ„Éº„É†</button>
    </div>

    <main class="calc-container">
        <!-- Ëá™ÂàÜÂÅ¥Ë®≠ÂÆö -->
        <section class="poke-settings ally tab-content active" id="tab-ally">
            <h2>Ëá™ÂàÜ</h2>
            
            <div class="hp-status">
                <div class="hp-text">HP: <span id="ally-current-hp">150</span> / <span id="ally-max-hp">150</span></div>
                <div class="hp-bar-container">
                    <div class="battle-hp-bar" id="ally-hp-bar" style="width: 100%; background-color: var(--primary-green);"></div>
                </div>
            </div>

            <div class="autocomplete-container">
                <input type="text" id="ally-name-input" placeholder="„Éù„Ç±„É¢„É≥Âêç„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ" class="search-input" autocomplete="off">
                <button type="button" class="clear-input-btn" data-target="ally-name-input" aria-label="ÂÖ•Âäõ„Çí„ÇØ„É™„Ç¢">√ó</button>
                <ul id="ally-autocomplete-list" class="autocomplete-list"></ul>
            </div>
            <div id="ally-base-stats" class="base-stats-info"></div>
            
            <!-- ‰ΩøÁî®Áéá„Éá„Éº„ÇøË°®Á§∫„Çª„ÇØ„Ç∑„Éß„É≥ -->
            <div class="usage-rate-section" id="ally-usage-rate-section" style="display: none;">
                <div class="usage-rate-header collapsed" id="ally-usage-rate-header">
                    <h3>Êé°Áî®Áéá„Éá„Éº„Çø„Çí„Åø„Çã <span class="toggle-icon">‚ñº</span></h3>
                </div>
                <div class="usage-rate-content collapsed" id="ally-usage-rate-content">
                    <div class="usage-rate-charts">
                        <div class="chart-container">
                            <h4><img class="usage-rate-icon" src="../backend/data/image/move_record.png" alt="ÊäÄ">ÊäÄ</h4>
                            <canvas id="ally-chart-trend-moves"></canvas>
                        </div>
                        <div class="chart-container">
                            <h4><img class="usage-rate-icon" src="../backend/data/image/item.png" alt="ÊåÅ„Å°Áâ©">ÊåÅ„Å°Áâ©</h4>
                            <canvas id="ally-chart-trend-items"></canvas>
                        </div>
                        <div class="chart-container">
                            <h4><img class="usage-rate-icon" src="../backend/data/image/mint.png" alt="ÊÄßÊ†º">ÊÄßÊ†º</h4>
                            <canvas id="ally-chart-trend-personalities"></canvas>
                        </div>
                        <div class="chart-container">
                            <h4><img class="usage-rate-icon" src="../backend/data/image/terastal.png" alt="„ÉÜ„É©„Çπ„Çø„Ç§„Éó">„ÉÜ„É©„Çπ„Çø„Ç§„Éó</h4>
                            <canvas id="ally-chart-trend-tera-types"></canvas>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="grid-params">
                <label>„ÉÜ„É©„Çπ„Çø„É´: 
                    <select id="ally-tera-select">
                        <option>„Å™„Åó</option>
                        <option>‰∏ÄËá¥„ÉÜ„É©„Çπ</option>
                        <option>‰∏ç‰∏ÄËá¥„ÉÜ„É©„Çπ</option>
                    </select>
                </label>
            </div>

            <div class="stats-container">
                <!-- HP (No Nature) -->
                <div class="stat-row">
                    <div class="stat-result-box">
                        <div class="stat-label">HP</div>
                        <div class="stat-value" id="ally-stat-val-hp">-</div>
                    </div>
                    <div class="stat-controls flex-row">
                        <div class="rank-group empty">
                            <!-- HP has no rank -->
                        </div>
                        <div class="ev-group">
                            <label>ËÉΩÂäõP</label>
                            <div class="ev-control-row">
                                <input type="number" class="stat-input ev-input" data-stat="hp" data-type="ev" value="0" max="32" min="0">
                                <button type="button" class="tune-btn" data-stat="hp" data-action="down" title="-1 ÂÆüÊï∞ÂÄ§">‚ñº</button>
                                <button type="button" class="tune-btn" data-stat="hp" data-action="up" title="+1 ÂÆüÊï∞ÂÄ§">‚ñ≤</button>
                                <button type="button" class="preset-btn" data-val="0">0</button>
                                <button type="button" class="preset-btn" data-val="32">32</button>
                            </div>
                        </div>
                        <div class="nature-group empty">
                            <!-- HP has no nature -->
                        </div>
                    </div>
                </div>

                <!-- Attack -->
                <div class="stat-row">
                    <div class="stat-result-box">
                        <div class="stat-label">„Åì„ÅÜ„Åí„Åç</div>
                        <div class="stat-value" id="ally-stat-val-attack">-</div>
                    </div>
                    <div class="stat-controls flex-row">
                        <div class="rank-group">
                            <label>„É©„É≥„ÇØ</label>
                            <select class="rank-select" data-stat="attack">
                                <option value="6">+6</option>
                                <option value="5">+5</option>
                                <option value="4">+4</option>
                                <option value="3">+3</option>
                                <option value="2">+2</option>
                                <option value="1">+1</option>
                                <option value="0" selected>¬±0</option>
                                <option value="-1">-1</option>
                                <option value="-2">-2</option>
                                <option value="-3">-3</option>
                                <option value="-4">-4</option>
                                <option value="-5">-5</option>
                                <option value="-6">-6</option>
                            </select>
                        </div>
                        <div class="ev-group">
                            <label>ËÉΩÂäõP</label>
                            <div class="ev-control-row">
                                <input type="number" class="stat-input ev-input" data-stat="attack" data-type="ev" value="0" max="32" min="0">
                                <button type="button" class="tune-btn" data-stat="attack" data-action="down" title="-1 ÂÆüÊï∞ÂÄ§">‚ñº</button>
                                <button type="button" class="tune-btn" data-stat="attack" data-action="up" title="+1 ÂÆüÊï∞ÂÄ§">‚ñ≤</button>
                                <button type="button" class="preset-btn" data-val="0">0</button>
                                <button type="button" class="preset-btn" data-val="32">32</button>
                            </div>
                        </div>
                        <div class="nature-group">
                            <label>ÊÄßÊ†º Ë£úÊ≠£</label>
                            <div class="nature-toggle">
                                <button type="button" class="nature-btn down" data-stat="attack" data-val="down">‚ñº</button>
                                <span class="nature-display" data-stat="attack"></span>
                                <button type="button" class="nature-btn up" data-stat="attack" data-val="up">‚ñ≤</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Defense -->
                <div class="stat-row">
                    <div class="stat-result-box">
                        <div class="stat-label">„Åº„ÅÜ„Åé„Çá</div>
                        <div class="stat-value" id="ally-stat-val-defense">-</div>
                    </div>
                    <div class="stat-controls flex-row">
                        <div class="rank-group">
                            <label>„É©„É≥„ÇØ</label>
                            <select class="rank-select" data-stat="defense">
                                <option value="6">+6</option>
                                <option value="5">+5</option>
                                <option value="4">+4</option>
                                <option value="3">+3</option>
                                <option value="2">+2</option>
                                <option value="1">+1</option>
                                <option value="0" selected>¬±0</option>
                                <option value="-1">-1</option>
                                <option value="-2">-2</option>
                                <option value="-3">-3</option>
                                <option value="-4">-4</option>
                                <option value="-5">-5</option>
                                <option value="-6">-6</option>
                            </select>
                        </div>
                        <div class="ev-group">
                            <label>ËÉΩÂäõP</label>
                            <div class="ev-control-row">
                                <input type="number" class="stat-input ev-input" data-stat="defense" data-type="ev" value="0" max="32" min="0">
                                <button type="button" class="tune-btn" data-stat="defense" data-action="down" title="-1 ÂÆüÊï∞ÂÄ§">‚ñº</button>
                                <button type="button" class="tune-btn" data-stat="defense" data-action="up" title="+1 ÂÆüÊï∞ÂÄ§">‚ñ≤</button>
                                <button type="button" class="preset-btn" data-val="0">0</button>
                                <button type="button" class="preset-btn" data-val="32">32</button>
                            </div>
                        </div>
                        <div class="nature-group">
                            <label>ÊÄßÊ†º Ë£úÊ≠£</label>
                            <div class="nature-toggle">
                                <button type="button" class="nature-btn down" data-stat="defense" data-val="down">‚ñº</button>
                                <span class="nature-display" data-stat="defense"></span>
                                <button type="button" class="nature-btn up" data-stat="defense" data-val="up">‚ñ≤</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- SpA -->
                <div class="stat-row">
                    <div class="stat-result-box">
                        <div class="stat-label">„Å®„Åè„Åì„ÅÜ</div>
                        <div class="stat-value" id="ally-stat-val-spAtk">-</div>
                    </div>
                    <div class="stat-controls flex-row">
                        <div class="rank-group">
                            <label>„É©„É≥„ÇØ</label>
                            <select class="rank-select" data-stat="spAtk">
                                <option value="6">+6</option>
                                <option value="5">+5</option>
                                <option value="4">+4</option>
                                <option value="3">+3</option>
                                <option value="2">+2</option>
                                <option value="1">+1</option>
                                <option value="0" selected>¬±0</option>
                                <option value="-1">-1</option>
                                <option value="-2">-2</option>
                                <option value="-3">-3</option>
                                <option value="-4">-4</option>
                                <option value="-5">-5</option>
                                <option value="-6">-6</option>
                            </select>
                        </div>
                        <div class="ev-group">
                            <label>ËÉΩÂäõP</label>
                            <div class="ev-control-row">
                                <input type="number" class="stat-input ev-input" data-stat="spAtk" data-type="ev" value="0" max="32" min="0">
                                <button type="button" class="tune-btn" data-stat="spAtk" data-action="down" title="-1 ÂÆüÊï∞ÂÄ§">‚ñº</button>
                                <button type="button" class="tune-btn" data-stat="spAtk" data-action="up" title="+1 ÂÆüÊï∞ÂÄ§">‚ñ≤</button>
                                <button type="button" class="preset-btn" data-val="0">0</button>
                                <button type="button" class="preset-btn" data-val="32">32</button>
                            </div>
                        </div>
                        <div class="nature-group">
                            <label>ÊÄßÊ†º Ë£úÊ≠£</label>
                            <div class="nature-toggle">
                                <button type="button" class="nature-btn down" data-stat="spAtk" data-val="down">‚ñº</button>
                                <span class="nature-display" data-stat="spAtk"></span>
                                <button type="button" class="nature-btn up" data-stat="spAtk" data-val="up">‚ñ≤</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- SpD -->
                <div class="stat-row">
                    <div class="stat-result-box">
                        <div class="stat-label">„Å®„Åè„Åº„ÅÜ</div>
                        <div class="stat-value" id="ally-stat-val-spDef">-</div>
                    </div>
                    <div class="stat-controls flex-row">
                        <div class="rank-group">
                            <label>„É©„É≥„ÇØ</label>
                            <select class="rank-select" data-stat="spDef">
                                <option value="6">+6</option>
                                <option value="5">+5</option>
                                <option value="4">+4</option>
                                <option value="3">+3</option>
                                <option value="2">+2</option>
                                <option value="1">+1</option>
                                <option value="0" selected>¬±0</option>
                                <option value="-1">-1</option>
                                <option value="-2">-2</option>
                                <option value="-3">-3</option>
                                <option value="-4">-4</option>
                                <option value="-5">-5</option>
                                <option value="-6">-6</option>
                            </select>
                        </div>
                        <div class="ev-group">
                            <label>ËÉΩÂäõP</label>
                            <div class="ev-control-row">
                                <input type="number" class="stat-input ev-input" data-stat="spDef" data-type="ev" value="0" max="32" min="0">
                                <button type="button" class="tune-btn" data-stat="spDef" data-action="down" title="-1 ÂÆüÊï∞ÂÄ§">‚ñº</button>
                                <button type="button" class="tune-btn" data-stat="spDef" data-action="up" title="+1 ÂÆüÊï∞ÂÄ§">‚ñ≤</button>
                                <button type="button" class="preset-btn" data-val="0">0</button>
                                <button type="button" class="preset-btn" data-val="32">32</button>
                            </div>
                        </div>
                        <div class="nature-group">
                            <label>ÊÄßÊ†º Ë£úÊ≠£</label>
                            <div class="nature-toggle">
                                <button type="button" class="nature-btn down" data-stat="spDef" data-val="down">‚ñº</button>
                                <span class="nature-display" data-stat="spDef"></span>
                                <button type="button" class="nature-btn up" data-stat="spDef" data-val="up">‚ñ≤</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Speed -->
                <div class="stat-row">
                    <div class="stat-result-box">
                        <div class="stat-label">„Åô„Å∞„ÇÑ„Åï</div>
                        <div class="stat-value" id="ally-stat-val-speed">-</div>
                    </div>
                    <div class="stat-controls flex-row">
                        <div class="rank-group">
                            <label>„É©„É≥„ÇØ</label>
                            <select class="rank-select" data-stat="speed">
                                <option value="6">+6</option>
                                <option value="5">+5</option>
                                <option value="4">+4</option>
                                <option value="3">+3</option>
                                <option value="2">+2</option>
                                <option value="1">+1</option>
                                <option value="0" selected>¬±0</option>
                                <option value="-1">-1</option>
                                <option value="-2">-2</option>
                                <option value="-3">-3</option>
                                <option value="-4">-4</option>
                                <option value="-5">-5</option>
                                <option value="-6">-6</option>
                            </select>
                        </div>
                        <div class="ev-group">
                            <label>ËÉΩÂäõP</label>
                            <div class="ev-control-row">
                                <input type="number" class="stat-input ev-input" data-stat="speed" data-type="ev" value="0" max="32" min="0">
                                <button type="button" class="tune-btn" data-stat="speed" data-action="down" title="-1 ÂÆüÊï∞ÂÄ§">‚ñº</button>
                                <button type="button" class="tune-btn" data-stat="speed" data-action="up" title="+1 ÂÆüÊï∞ÂÄ§">‚ñ≤</button>
                                <button type="button" class="preset-btn" data-val="0">0</button>
                                <button type="button" class="preset-btn" data-val="32">32</button>
                            </div>
                        </div>
                        <div class="nature-group">
                            <label>ÊÄßÊ†º Ë£úÊ≠£</label>
                            <div class="nature-toggle">
                                <button type="button" class="nature-btn down" data-stat="speed" data-val="down">‚ñº</button>
                                <span class="nature-display" data-stat="speed"></span>
                                <button type="button" class="nature-btn up" data-stat="speed" data-val="up">‚ñ≤</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="options">
                <label><span class="option-label">ÁâπÊÄß:</span><select id="ally-ability-select"><option>Êú™Ë®≠ÂÆö</option></select></label>
                <label><span class="option-label">ÊåÅ„Å°Áâ©:</span>
                    <select id="ally-item-select">
                        <option value="">Êú™Ë®≠ÂÆö</option>
                    </select>
                    <button type="button" class="item-trigger-btn" data-side="ally" title="ÊåÅ„Å°Áâ©„ÅÆÂäπÊûú„ÇíÊâãÂãï„ÅßÁô∫Âãï„Åó„Åæ„Åô">Áô∫Âãï</button>
                    <span id="ally-item-status" class="item-status"></span>
                </label>
            </div>

            <div class="move-selector">
                <h3>ÊäÄ</h3>
                <div class="move-config-grid">
                    <div class="move-row">
                        <input type="radio" name="ally-active-move" value="0" class="move-select-radio" checked>
                        <div class="move-input-wrapper">
                            <div class="move-input-field">
                                <input class="move-select" data-index="0" id="ally-move-0" placeholder="ÊäÄ1" autocomplete="off">
                                <button type="button" class="clear-input-btn" data-target="ally-move-0" aria-label="ÂÖ•Âäõ„Çí„ÇØ„É™„Ç¢">√ó</button>
                            </div>
                            <ul class="custom-autocomplete-list"></ul>
                            <div class="move-info-display"></div>
                        </div>
                    </div>
                    <div class="move-row">
                        <input type="radio" name="ally-active-move" value="1" class="move-select-radio">
                        <div class="move-input-wrapper">
                            <div class="move-input-field">
                                <input class="move-select" data-index="1" id="ally-move-1" placeholder="ÊäÄ2" autocomplete="off">
                                <button type="button" class="clear-input-btn" data-target="ally-move-1" aria-label="ÂÖ•Âäõ„Çí„ÇØ„É™„Ç¢">√ó</button>
                            </div>
                            <ul class="custom-autocomplete-list"></ul>
                            <div class="move-info-display"></div>
                        </div>
                    </div>
                    <div class="move-row">
                        <input type="radio" name="ally-active-move" value="2" class="move-select-radio">
                        <div class="move-input-wrapper">
                            <div class="move-input-field">
                                <input class="move-select" data-index="2" id="ally-move-2" placeholder="ÊäÄ3" autocomplete="off">
                                <button type="button" class="clear-input-btn" data-target="ally-move-2" aria-label="ÂÖ•Âäõ„Çí„ÇØ„É™„Ç¢">√ó</button>
                            </div>
                            <ul class="custom-autocomplete-list"></ul>
                            <div class="move-info-display"></div>
                        </div>
                    </div>
                    <div class="move-row">
                        <input type="radio" name="ally-active-move" value="3" class="move-select-radio">
                        <div class="move-input-wrapper">
                            <div class="move-input-field">
                                <input class="move-select" data-index="3" id="ally-move-3" placeholder="ÊäÄ4" autocomplete="off">
                                <button type="button" class="clear-input-btn" data-target="ally-move-3" aria-label="ÂÖ•Âäõ„Çí„ÇØ„É™„Ç¢">√ó</button>
                            </div>
                            <ul class="custom-autocomplete-list"></ul>
                            <div class="move-info-display"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="field-conditions ally-conditions">
                <h3>„Éï„Ç£„Éº„É´„Éâ„ÉªÁä∂ÊÖã</h3>
                <label><input type="checkbox" class="condition-check" data-cond="isReflector"> „É™„Éï„É¨„ÇØ„Çø„Éº</label>
                <label><input type="checkbox" class="condition-check" data-cond="isMultiTarget"> Ë§áÊï∞ÂØæË±°ÊîªÊíÉ(3/4ÂÄç) [5]</label>
                <label><input type="checkbox" class="condition-check" data-cond="isCrit"> ÊÄ•ÊâÄ [6]</label>
            </div>

            <div class="damage-history-container">
                <div class="history-header">
                    <h4>Ë¢´„ÉÄ„É°„Éº„Ç∏Â±•Ê≠¥</h4>
                    <button class="clear-history-btn" data-side="ally">„ÇØ„É™„Ç¢</button>
                </div>
                <ul class="damage-history" id="ally-damage-history"></ul>
            </div>
        </section>

        <!-- Ë®àÁÆóÁµêÊûúË°®Á§∫Ôºà‰∏≠Â§ÆÔºâ -->
        <section class="result-display tab-content" id="tab-battle">
            <div class="action-panel">
                <div class="action-buttons">
                <!-- ÊîªÊíÉÊñπÂêë„Éú„Çø„É≥ -->
                 <p>„ÄêÊîªÊíÉ„Éú„Çø„É≥„Äë</p>
                 <div class="action-buttons-container">
                    <button id="execute-ally-attack" class="action-btn ally-attack-btn">
                        <img src="../backend/data/image/trainer_ally.png" alt="Ally" class="trainer-icon">
                        <span class="btn-main-text">Ëá™ÂàÜ„ÅåÊîªÊíÉ</span>
                    </button>
                    
                    <button id="execute-enemy-attack" class="action-btn enemy-attack-btn">
                        <img src="../backend/data/image/trainer_enemy.png" alt="Enemy" class="trainer-icon">
                        <span class="btn-main-text">Áõ∏Êâã„ÅåÊîªÊíÉ</span>
                    </button>
                 </div>

            </div>
            </div>

            <!-- Centralized Damage Result -->
            <div class="damage-result-container">
                <h3>Ë®àÁÆóÁµêÊûú</h3>
                <div class="result-header-display" style="display: none;">
                    <div class="icon-wrapper">
                        <img id="result-ally-icon" class="pokemon-icon-small" src="" alt="">
                        <div class="mini-hp-bar"><div id="result-ally-mini-hp-fill" class="mini-hp-bar-fill"></div></div>
                    </div>
                    <div class="move-arrow-display">
                        <span id="result-move-name" class="move-name-display"></span>
                        <div class="arrow-icon" id="result-arrow-icon">‚ûú</div>
                    </div>
                    <div class="icon-wrapper">
                        <img id="result-enemy-icon" class="pokemon-icon-small" src="" alt="">
                        <div class="mini-hp-bar"><div id="result-enemy-mini-hp-fill" class="mini-hp-bar-fill"></div></div>
                    </div>
                </div>
                <div class="result-row">
                    <span class="label">„ÉÄ„É°„Éº„Ç∏:</span>
                    <span class="value damage-range"></span>
                </div>
                <div class="result-row">
                    <span class="label">ÁÄïÊ≠ªÁéá:</span>
                    <span class="value kill-chance"></span>
                </div>
                <div class="result-row">
                    <span class="label">ÊåÅ„Å°Áâ©Ë£úÊ≠£:</span>
                    <span class="value item-modifier"></span>
                </div>
                <div class="result-row">
                    <span class="label">Êé°Áî®‰π±Êï∞:</span>
                    <select class="random-select" id="battle-random-roll">
                        <option value="-1">-- ‰π±Êï∞ÈÅ∏Êäû --</option>
                    </select>
                </div>
            </div>

            <hr>
            <div class="battle-log-header">
                <h3>ÂØæÊà¶„É≠„Ç∞</h3>
                <button id="clear-battle-log-btn" class="clear-history-btn">„É≠„Ç∞Ê∂àÂéª</button>
            </div>
            <div id="battle-log-container" class="battle-log-container">
                <ul id="battle-log-list" class="battle-log-list">
                    <!-- ÂÖ®‰Ωì„ÅÆ„Çø„Éº„É≥Â±•Ê≠¥„ÅåË°®Á§∫„Åï„Çå„Çã -->
                    <li class="log-placeholder">ÊîªÊíÉ„Éú„Çø„É≥„ÇíÊäº„Åô„Å®ÂØæÊà¶„ÅÆË®òÈå≤„Åå„Åì„Åì„Å´Ë°®Á§∫„Åï„Çå„Åæ„Åô</li>
                </ul>
            </div>
        </section>

        <!-- Áõ∏ÊâãÂÅ¥Ë®≠ÂÆö -->
        <section class="poke-settings enemy tab-content" id="tab-enemy">
            <h2>Áõ∏Êâã</h2>
            
            <div class="hp-status">
                <div class="hp-text">HP: <span id="enemy-current-hp">150</span> / <span id="enemy-max-hp">150</span></div>
                <div class="hp-bar-container">
                    <div class="battle-hp-bar" id="enemy-hp-bar" style="width: 100%; background-color: var(--primary-green);"></div>
                </div>
            </div>

            <div class="autocomplete-container">
                <input type="text" id="enemy-name-input" placeholder="„Éù„Ç±„É¢„É≥Âêç„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ" class="search-input" autocomplete="off">
                <button type="button" class="clear-input-btn" data-target="enemy-name-input" aria-label="ÂÖ•Âäõ„Çí„ÇØ„É™„Ç¢">√ó</button>
                <ul id="enemy-autocomplete-list" class="autocomplete-list"></ul>
            </div>
            <div id="enemy-base-stats" class="base-stats-info"></div>
            
            <!-- ‰ΩøÁî®Áéá„Éá„Éº„ÇøË°®Á§∫„Çª„ÇØ„Ç∑„Éß„É≥ -->
            <div class="usage-rate-section" id="enemy-usage-rate-section" style="display: none;">
                <div class="usage-rate-header collapsed" id="enemy-usage-rate-header">
                    <h3>Êé°Áî®Áéá„Éá„Éº„Çø„Çí„Åø„Çã <span class="toggle-icon">‚ñº</span></h3>
                </div>
                <div class="usage-rate-content collapsed" id="enemy-usage-rate-content">
                    <div class="usage-rate-charts">
                        <div class="chart-container">
                            <h4><img class="usage-rate-icon" src="../backend/data/image/move_record.png" alt="ÊäÄ">ÊäÄ</h4>
                            <canvas id="enemy-chart-trend-moves"></canvas>
                        </div>
                        <div class="chart-container">
                            <h4><img class="usage-rate-icon" src="../backend/data/image/item.png" alt="ÊåÅ„Å°Áâ©">ÊåÅ„Å°Áâ©</h4>
                            <canvas id="enemy-chart-trend-items"></canvas>
                        </div>
                        <div class="chart-container">
                            <h4><img class="usage-rate-icon" src="../backend/data/image/ability.png" alt="ÊÄßÊ†º">ÊÄßÊ†º</h4>
                            <canvas id="enemy-chart-trend-personalities"></canvas>
                        </div>
                        <div class="chart-container">
                            <h4><img class="usage-rate-icon" src="../backend/data/image/terastal.png" alt="„ÉÜ„É©„Çπ„Çø„Ç§„Éó">„ÉÜ„É©„Çπ„Çø„Ç§„Éó</h4>
                            <canvas id="enemy-chart-trend-tera-types"></canvas>
                        </div>
                    </div>
                </div>
            </div>
            
                <div class="stats-container">
                <!-- HP (No Nature) -->
                <div class="stat-row">
                    <div class="stat-result-box">
                        <div class="stat-label">HP</div>
                        <div class="stat-value" id="enemy-stat-val-hp">-</div>
                    </div>
                    <div class="stat-controls flex-row">
                        <div class="rank-group empty">
                            <!-- HP has no rank -->
                        </div>
                        <div class="ev-group">
                            <label>ËÉΩÂäõP</label>
                            <div class="ev-control-row">
                                <input type="number" class="stat-input ev-input" data-stat="hp" data-type="ev" value="0" max="32" min="0">
                                <button type="button" class="tune-btn" data-stat="hp" data-action="down" title="-1 ÂÆüÊï∞ÂÄ§">‚ñº</button>
                                <button type="button" class="tune-btn" data-stat="hp" data-action="up" title="+1 ÂÆüÊï∞ÂÄ§">‚ñ≤</button>
                                <button type="button" class="preset-btn" data-val="0">0</button>
                                <button type="button" class="preset-btn" data-val="32">32</button>
                            </div>
                        </div>
                        <div class="nature-group empty">
                            <!-- HP has no nature -->
                        </div>
                    </div>
                </div>

                <!-- Attack -->
                <div class="stat-row">
                    <div class="stat-result-box">
                        <div class="stat-label">„Åì„ÅÜ„Åí„Åç</div>
                        <div class="stat-value" id="enemy-stat-val-attack">-</div>
                    </div>
                    <div class="stat-controls flex-row">
                        <div class="rank-group">
                            <label>„É©„É≥„ÇØ</label>
                            <select class="rank-select" data-stat="attack">
                                <option value="6">+6</option>
                                <option value="5">+5</option>
                                <option value="4">+4</option>
                                <option value="3">+3</option>
                                <option value="2">+2</option>
                                <option value="1">+1</option>
                                <option value="0" selected>¬±0</option>
                                <option value="-1">-1</option>
                                <option value="-2">-2</option>
                                <option value="-3">-3</option>
                                <option value="-4">-4</option>
                                <option value="-5">-5</option>
                                <option value="-6">-6</option>
                            </select>
                        </div>
                        <div class="ev-group">
                            <label>ËÉΩÂäõP</label>
                            <div class="ev-control-row">
                                <input type="number" class="stat-input ev-input" data-stat="attack" data-type="ev" value="0" max="32" min="0">
                                <button type="button" class="tune-btn" data-stat="attack" data-action="down" title="-1 ÂÆüÊï∞ÂÄ§">‚ñº</button>
                                <button type="button" class="tune-btn" data-stat="attack" data-action="up" title="+1 ÂÆüÊï∞ÂÄ§">‚ñ≤</button>
                                <button type="button" class="preset-btn" data-val="0">0</button>
                                <button type="button" class="preset-btn" data-val="32">32</button>
                            </div>
                        </div>
                        <div class="nature-group">
                            <label>ÊÄßÊ†º Ë£úÊ≠£</label>
                            <div class="nature-toggle">
                                <button type="button" class="nature-btn down" data-stat="attack" data-val="down">‚ñº</button>
                                <span class="nature-display" data-stat="attack"></span>
                                <button type="button" class="nature-btn up" data-stat="attack" data-val="up">‚ñ≤</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Defense -->
                <div class="stat-row">
                    <div class="stat-result-box">
                        <div class="stat-label">„Åº„ÅÜ„Åé„Çá</div>
                        <div class="stat-value" id="enemy-stat-val-defense">-</div>
                    </div>
                    <div class="stat-controls flex-row">
                        <div class="rank-group">
                            <label>„É©„É≥„ÇØ</label>
                            <select class="rank-select" data-stat="defense">
                                <option value="6">+6</option>
                                <option value="5">+5</option>
                                <option value="4">+4</option>
                                <option value="3">+3</option>
                                <option value="2">+2</option>
                                <option value="1">+1</option>
                                <option value="0" selected>¬±0</option>
                                <option value="-1">-1</option>
                                <option value="-2">-2</option>
                                <option value="-3">-3</option>
                                <option value="-4">-4</option>
                                <option value="-5">-5</option>
                                <option value="-6">-6</option>
                            </select>
                        </div>
                        <div class="ev-group">
                            <label>ËÉΩÂäõP</label>
                            <div class="ev-control-row">
                                <input type="number" class="stat-input ev-input" data-stat="defense" data-type="ev" value="0" max="32" min="0">
                                <button type="button" class="tune-btn" data-stat="defense" data-action="down" title="-1 ÂÆüÊï∞ÂÄ§">‚ñº</button>
                                <button type="button" class="tune-btn" data-stat="defense" data-action="up" title="+1 ÂÆüÊï∞ÂÄ§">‚ñ≤</button>
                                <button type="button" class="preset-btn" data-val="0">0</button>
                                <button type="button" class="preset-btn" data-val="32">32</button>
                            </div>
                        </div>
                        <div class="nature-group">
                            <label>ÊÄßÊ†º Ë£úÊ≠£</label>
                            <div class="nature-toggle">
                                <button type="button" class="nature-btn down" data-stat="defense" data-val="down">‚ñº</button>
                                <span class="nature-display" data-stat="defense"></span>
                                <button type="button" class="nature-btn up" data-stat="defense" data-val="up">‚ñ≤</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- SpA -->
                <div class="stat-row">
                    <div class="stat-result-box">
                        <div class="stat-label">„Å®„Åè„Åì„ÅÜ</div>
                        <div class="stat-value" id="enemy-stat-val-spAtk">-</div>
                    </div>
                    <div class="stat-controls flex-row">
                        <div class="rank-group">
                            <label>„É©„É≥„ÇØ</label>
                            <select class="rank-select" data-stat="spAtk">
                                <option value="6">+6</option>
                                <option value="5">+5</option>
                                <option value="4">+4</option>
                                <option value="3">+3</option>
                                <option value="2">+2</option>
                                <option value="1">+1</option>
                                <option value="0" selected>¬±0</option>
                                <option value="-1">-1</option>
                                <option value="-2">-2</option>
                                <option value="-3">-3</option>
                                <option value="-4">-4</option>
                                <option value="-5">-5</option>
                                <option value="-6">-6</option>
                            </select>
                        </div>
                        <div class="ev-group">
                            <label>ËÉΩÂäõP</label>
                            <div class="ev-control-row">
                                <input type="number" class="stat-input ev-input" data-stat="spAtk" data-type="ev" value="0" max="32" min="0">
                                <button type="button" class="tune-btn" data-stat="spAtk" data-action="down" title="-1 ÂÆüÊï∞ÂÄ§">‚ñº</button>
                                <button type="button" class="tune-btn" data-stat="spAtk" data-action="up" title="+1 ÂÆüÊï∞ÂÄ§">‚ñ≤</button>
                                <button type="button" class="preset-btn" data-val="0">0</button>
                                <button type="button" class="preset-btn" data-val="32">32</button>
                            </div>
                        </div>
                        <div class="nature-group">
                            <label>ÊÄßÊ†º Ë£úÊ≠£</label>
                            <div class="nature-toggle">
                                <button type="button" class="nature-btn down" data-stat="spAtk" data-val="down">‚ñº</button>
                                <span class="nature-display" data-stat="spAtk"></span>
                                <button type="button" class="nature-btn up" data-stat="spAtk" data-val="up">‚ñ≤</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- SpD -->
                <div class="stat-row">
                    <div class="stat-result-box">
                        <div class="stat-label">„Å®„Åè„Åº„ÅÜ</div>
                        <div class="stat-value" id="enemy-stat-val-spDef">-</div>
                    </div>
                    <div class="stat-controls flex-row">
                        <div class="rank-group">
                            <label>„É©„É≥„ÇØ</label>
                            <select class="rank-select" data-stat="spDef">
                                <option value="6">+6</option>
                                <option value="5">+5</option>
                                <option value="4">+4</option>
                                <option value="3">+3</option>
                                <option value="2">+2</option>
                                <option value="1">+1</option>
                                <option value="0" selected>¬±0</option>
                                <option value="-1">-1</option>
                                <option value="-2">-2</option>
                                <option value="-3">-3</option>
                                <option value="-4">-4</option>
                                <option value="-5">-5</option>
                                <option value="-6">-6</option>
                            </select>
                        </div>
                        <div class="ev-group">
                            <label>ËÉΩÂäõP</label>
                            <div class="ev-control-row">
                                <input type="number" class="stat-input ev-input" data-stat="spDef" data-type="ev" value="0" max="32" min="0">
                                <button type="button" class="tune-btn" data-stat="spDef" data-action="down" title="-1 ÂÆüÊï∞ÂÄ§">‚ñº</button>
                                <button type="button" class="tune-btn" data-stat="spDef" data-action="up" title="+1 ÂÆüÊï∞ÂÄ§">‚ñ≤</button>
                                <button type="button" class="preset-btn" data-val="0">0</button>
                                <button type="button" class="preset-btn" data-val="32">32</button>
                            </div>
                        </div>
                        <div class="nature-group">
                            <label>ÊÄßÊ†º Ë£úÊ≠£</label>
                            <div class="nature-toggle">
                                <button type="button" class="nature-btn down" data-stat="spDef" data-val="down">‚ñº</button>
                                <span class="nature-display" data-stat="spDef"></span>
                                <button type="button" class="nature-btn up" data-stat="spDef" data-val="up">‚ñ≤</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Speed -->
                <div class="stat-row">
                    <div class="stat-result-box">
                        <div class="stat-label">„Åô„Å∞„ÇÑ„Åï</div>
                        <div class="stat-value" id="enemy-stat-val-speed">-</div>
                    </div>
                    <div class="stat-controls flex-row">
                        <div class="rank-group">
                            <label>„É©„É≥„ÇØ</label>
                            <select class="rank-select" data-stat="speed">
                                <option value="6">+6</option>
                                <option value="5">+5</option>
                                <option value="4">+4</option>
                                <option value="3">+3</option>
                                <option value="2">+2</option>
                                <option value="1">+1</option>
                                <option value="0" selected>¬±0</option>
                                <option value="-1">-1</option>
                                <option value="-2">-2</option>
                                <option value="-3">-3</option>
                                <option value="-4">-4</option>
                                <option value="-5">-5</option>
                                <option value="-6">-6</option>
                            </select>
                        </div>
                        <div class="ev-group">
                            <label>ËÉΩÂäõP</label>
                            <div class="ev-control-row">
                                <input type="number" class="stat-input ev-input" data-stat="speed" data-type="ev" value="0" max="32" min="0">
                                <button type="button" class="tune-btn" data-stat="speed" data-action="down" title="-1 ÂÆüÊï∞ÂÄ§">‚ñº</button>
                                <button type="button" class="tune-btn" data-stat="speed" data-action="up" title="+1 ÂÆüÊï∞ÂÄ§">‚ñ≤</button>
                                <button type="button" class="preset-btn" data-val="0">0</button>
                                <button type="button" class="preset-btn" data-val="32">32</button>
                            </div>
                        </div>
                        <div class="nature-group">
                            <label>ÊÄßÊ†º Ë£úÊ≠£</label>
                            <div class="nature-toggle">
                                <button type="button" class="nature-btn down" data-stat="speed" data-val="down">‚ñº</button>
                                <span class="nature-display" data-stat="speed"></span>
                                <button type="button" class="nature-btn up" data-stat="speed" data-val="up">‚ñ≤</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            </div>

            <div class="options">
                <label><span class="option-label">ÁâπÊÄß:</span><select id="enemy-ability-select"><option>Êú™Ë®≠ÂÆö</option></select></label>
                <label><span class="option-label">ÊåÅ„Å°Áâ©:</span>
                    <select id="enemy-item-select">
                        <option value="">Êú™Ë®≠ÂÆö</option>
                    </select>
                    <button type="button" class="item-trigger-btn" data-side="enemy" title="ÊåÅ„Å°Áâ©„ÅÆÂäπÊûú„ÇíÊâãÂãï„ÅßÁô∫Âãï„Åó„Åæ„Åô">Áô∫Âãï</button>
                    <span id="enemy-item-status" class="item-status"></span>
                </label>
            </div>

            <div class="move-selector">
                <h3>ÊäÄ</h3>
                <div class="move-config-grid">
                    <div class="move-row">
                        <input type="radio" name="enemy-active-move" value="0" class="move-select-radio" checked>
                        <div class="move-input-wrapper">
                            <div class="move-input-field">
                                <input class="move-select" data-index="0" id="enemy-move-0" placeholder="ÊäÄ1" autocomplete="off">
                                <button type="button" class="clear-input-btn" data-target="enemy-move-0" aria-label="ÂÖ•Âäõ„Çí„ÇØ„É™„Ç¢">√ó</button>
                            </div>
                            <ul class="custom-autocomplete-list"></ul>
                            <div class="move-info-display"></div>
                        </div>
                    </div>
                    <div class="move-row">
                        <input type="radio" name="enemy-active-move" value="1" class="move-select-radio">
                        <div class="move-input-wrapper">
                            <div class="move-input-field">
                                <input class="move-select" data-index="1" id="enemy-move-1" placeholder="ÊäÄ2" autocomplete="off">
                                <button type="button" class="clear-input-btn" data-target="enemy-move-1" aria-label="ÂÖ•Âäõ„Çí„ÇØ„É™„Ç¢">√ó</button>
                            </div>
                            <ul class="custom-autocomplete-list"></ul>
                            <div class="move-info-display"></div>
                        </div>
                    </div>
                    <div class="move-row">
                        <input type="radio" name="enemy-active-move" value="2" class="move-select-radio">
                        <div class="move-input-wrapper">
                            <div class="move-input-field">
                                <input class="move-select" data-index="2" id="enemy-move-2" placeholder="ÊäÄ3" autocomplete="off">
                                <button type="button" class="clear-input-btn" data-target="enemy-move-2" aria-label="ÂÖ•Âäõ„Çí„ÇØ„É™„Ç¢">√ó</button>
                            </div>
                            <ul class="custom-autocomplete-list"></ul>
                            <div class="move-info-display"></div>
                        </div>
                    </div>
                    <div class="move-row">
                        <input type="radio" name="enemy-active-move" value="3" class="move-select-radio">
                        <div class="move-input-wrapper">
                            <div class="move-input-field">
                                <input class="move-select" data-index="3" id="enemy-move-3" placeholder="ÊäÄ4" autocomplete="off">
                                <button type="button" class="clear-input-btn" data-target="enemy-move-3" aria-label="ÂÖ•Âäõ„Çí„ÇØ„É™„Ç¢">√ó</button>
                            </div>
                            <ul class="custom-autocomplete-list"></ul>
                            <div class="move-info-display"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="field-conditions enemy-conditions">
                <h3>„Éï„Ç£„Éº„É´„Éâ„ÉªÁä∂ÊÖã</h3>
                <label><input type="checkbox" class="condition-check" data-cond="isReflector"> „É™„Éï„É¨„ÇØ„Çø„Éº</label>
                <label><input type="checkbox" class="condition-check" data-cond="isMultiTarget"> Ë§áÊï∞ÂØæË±°ÊîªÊíÉ(3/4ÂÄç) [5]</label>
                <label><input type="checkbox" class="condition-check" data-cond="isCrit"> ÊÄ•ÊâÄ [6]</label>
            </div>
            
            <div class="damage-history-container">
                <div class="history-header">
                    <h4>Ë¢´„ÉÄ„É°„Éº„Ç∏Â±•Ê≠¥</h4>
                    <button class="clear-history-btn" data-side="enemy">„ÇØ„É™„Ç¢</button>
                </div>
                <ul class="damage-history" id="enemy-damage-history"></ul>
            </div>
        </section>
    </main>


    <div class="mobile-sticky-footer">
    <div class="mobile-sticky-footer">
        <div class="mobile-action-buttons">
            <button id="mobile-attack-ally" class="mobile-action-btn ally-attack">
                <img src="../backend/data/image/trainer_ally.png" alt="Ally" class="mobile-trainer-icon">
                <span class="mobile-btn-text">Ëá™ÂàÜ„ÅåÊîªÊíÉ</span>
            </button>
            <button id="mobile-attack-enemy" class="mobile-action-btn enemy-attack">
                <span class="mobile-btn-text">Áõ∏Êâã„ÅåÊîªÊíÉ</span>
                <img src="../backend/data/image/trainer_enemy.png" alt="Enemy" class="mobile-trainer-icon">
            </button>
        </div>
    </div>

    <script type="module" src="js/data/loader.js?v=121"></script>
    <script type="module" src="js/calc/stats.js?v=118"></script>
    <script type="module" src="js/calc/damage.js?v=202"></script>
    <script type="module" src="js/models/PokemonModel.js?v=118"></script>
    <script type="module" src="js/AppState.js?v=117"></script>
    <script type="module" src="js/main.js?v=129"></script>
</body>
</html>